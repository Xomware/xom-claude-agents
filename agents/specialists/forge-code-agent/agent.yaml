metadata:
  name: "forge-code-agent"
  description: "Code generation, refactoring, and review specialist"
  version: "1.0.0"
  author: "Xomware"
  tags: ["code", "development", "refactoring"]

model:
  provider: "anthropic"
  name: "claude-sonnet-4-6"
  temperature: 0.2
  max_tokens: 4000
  routing_enabled: true
  routing_config: "../../../templates/model-routing.yaml"
  routing_rationale: "Code generation and review is Sonnet territory; escalate to Opus only for architecture_design or security_audit task types"

performance:
  latency_sla_ms: 30000
  target_response_time_ms: 10000
  max_concurrent_requests: 5
  timeout_ms: 60000

system_prompt_file: "prompts/system.md"

expertise:
  languages:
    - "Python"
    - "JavaScript/TypeScript"
    - "Go"
    - "Rust"
    - "Java"
    - "C++"
    - "SQL"
    - "Bash"
  specialties:
    - "Code generation"
    - "Refactoring"
    - "Code review"
    - "Bug fixing"
    - "Performance optimization"
    - "Test writing"

constraints:
  max_response_length: 5000
  max_tokens_per_request: 4000
  rate_limit:
    requests_per_minute: 30
  content_filters:
    - "malicious_code"
    - "hardcoded_secrets"

tools:
  # MCP Discipline â€” enforced via scripts/mcp-audit.sh
  max_enabled: 10
  audit_frequency: "weekly"

  - name: "write_code"
    enabled: true
  - name: "review_code"
    enabled: true
  - name: "run_linter"
    enabled: true
  - name: "execute_tests"
    enabled: true
  - name: "analyze_performance"
    enabled: true
  - name: "git_operations"
    enabled: true
  - name: "query_codebase"
    enabled: true
  - name: "suggest_improvements"
    enabled: true

quality_gates:
  - type: "code_lint"
    enabled: true
    strict: false
  - type: "test_coverage"
    enabled: true
    min_coverage: 70
  - type: "security_check"
    enabled: true
    fail_on: ["critical"]
  - type: "format_check"
    enabled: true

behavior:
  style: "detailed"
  tone: "technical"
  explain_reasoning: true
  provide_alternatives: true
  suggest_best_practices: true

metadata_tags:
  - "production"
  - "development"
  - "code-quality"

cost_controls:
  track_model_usage: true
  alert_if_opus_percent_exceeds: 15
  monthly_budget_usd: 50
  preferred_model_target:
    haiku_min_percent: 40
    sonnet_max_percent: 50
    opus_max_percent: 10
